# Default values for kagent
replicaCount: 1

# When true: pods use the default service account and no ClusterRole/ClusterRoleBinding are created.
# When false: a dedicated ServiceAccount and RBAC are created.
useDefaultServiceAccount: false

global:
  tag: ""

tools:
  metrics:
    # port defaults to the main --port value (same server). Set explicitly for a dedicated metrics port.
    port: ""
    servicemonitor:
      enabled: false
      interval: 30s
      scrapeTimeout: 10s
      labels:
        release: prometheus
  loglevel: "debug"
  # List of tool providers to enable. Empty list means all tools are enabled.
  # Available: k8s, helm, istio, cilium, argo, prometheus, kubescape, utils
  enabledTools: []
  #  - k8s
  #  - helm
  #  - prometheus
  # Additional command-line arguments
  args: []
  #  - "--some-future-flag"
  image:
    registry: ghcr.io
    repository: kagent-dev/kagent/tools
    tag: ""
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 1000m
      memory: 512Mi
  k8s:
    # When true: a Bearer token in the Authorization header on each request is passed to kubectl; fails if missing
    # When false: kubectl uses in-cluster ServiceAccount.
    tokenPassthrough: false
  prometheus:
    url: "prometheus.kagent.svc.cluster.local:9090"
    username: ""
    password: ""
  grafana: # kubectl port-forward svc/grafana 3000:3000
    url: "http://grafana.kagent.svc.cluster.local:3000"
    apiKey: ""

service:
  type: ClusterIP
  ports:
    tools:
      port: 8084
      targetPort: 8084
      nodePort:  # Only used if service.type is NodePort

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

podAnnotations: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000
  
# Node taints which will be tolerated for Pod.
tolerations: []

# Node labels to match for Pod.
nodeSelector: {}

# Affinity settings for Pod.
affinity: {}
#  nodeAffinity:
#    requiredDuringSchedulingIgnoredDuringExecution:
#      nodeSelectorTerms:
#        - matchExpressions:
#            - key: kubernetes.io/e2e-az-name
#              operator: In
#              values:
#                - e2e-az1

# Topology spread constraints for Pod.
topologySpreadConstraints: []
#  - maxSkew: 1
#    topologyKey: topology.kubernetes.io/zone
#    whenUnsatisfiable: DoNotSchedule

rbac:
  # When false, no ClusterRole or ClusterRoleBinding are created.
  # The ServiceAccount is still created allowing you to attach your own roles externally.
  create: true
  # When true, deploys a read-only ClusterRole (get, list, watch) instead of cluster-admin.
  # Pairs well with the --read-only CLI flag which disables write operations at the application layer.
  # Only applies when rbac.create is true.
  # Defaults to False as to not introduce breaking changes. Worth revisiting later on.
  readOnly: false
  # When readOnly is true, grants read access to Secrets. Default: no access to Secrets.
  # Ignored when readOnly is false (admin already has full access).
  allowSecrets: false
  # Extra rules appended to the read-only ClusterRole.  Useful for granting read access to CRDs (Istio, Cilium, Argo, etc.).
  # Ignored when readOnly is false (admin already has full access).
  additionalRules: []
  #  - apiGroups: ["networking.istio.io"]
  #    resources: ["virtualservices", "destinationrules", "gateways"]
  #    verbs: ["get", "list", "watch"]

otel:
  tracing:
    enabled: false
    exporter:
      otlp:
        endpoint: http://host.docker.internal:4317
        timeout: 15
        insecure: true
